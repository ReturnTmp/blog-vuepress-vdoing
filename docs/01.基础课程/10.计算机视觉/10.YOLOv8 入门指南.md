---
title: YOLOv8 å¿«é€Ÿå…¥é—¨
date: 2023-09-07 16:32:34
permalink: /pages/66172e/
categories:
  - è®¡ç®—æœºè§†è§‰
tags:
  - 
author: 
  name: ReturnTmp
  link: https://github.com/ReturnTmp
---



## å‰è¨€

æœ¬æ–‡æ˜¯ YOLOv8 å…¥é—¨æŒ‡å—ï¼ˆå¤§ä½¬è¯·ç»•è¿‡ï¼‰ï¼Œå°†ä¼šè¯¦ç»†è®²è§£å®‰è£…ï¼Œé…ç½®ï¼Œè®­ç»ƒï¼ŒéªŒè¯ï¼Œé¢„æµ‹ç­‰è¿‡ç¨‹

YOLOv8 å®˜ç½‘ï¼š[ultralytics/ultralytics: NEW - YOLOv8 ğŸš€ in PyTorch > ONNX > OpenVINO > CoreML > TFLite (github.com)](https://github.com/ultralytics/ultralytics)

![image-20230907184341725](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309082004362.png)



> æ³¨æ„ï¼šå¦‚æœé‡åˆ°æƒé‡æ–‡ä»¶ï¼Œæ¨¡å‹æ–‡ä»¶ä¸‹è½½ç¼“æ…¢çš„é—®é¢˜ï¼Œå¯ä»¥åœ¨è‡ªå·±æœ¬æœºä¸Šä¸‹è½½ï¼Œå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©ä»£ç†æˆ–æ˜¯ IDM è¿™æ ·çš„ä¸‹è½½è½¯ä»¶

## å®‰è£…é…ç½®

### è™šæ‹Ÿç¯å¢ƒ

æœ¬æ–‡ä½¿ç”¨ conda åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œæ²¡æœ‰é…ç½® conda ä¹Ÿå¯ä»¥ä½¿ç”¨ python venv è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºç¯å¢ƒ
conda create -n pytorch python=3.8 -y
# æŸ¥çœ‹ç¯å¢ƒ
conda env list
# æ¿€æ´»ç¯å¢ƒ
conda activate pytorch
```

### å®‰è£…ä¾èµ–

è¯·è‡ªè¡Œåˆ° [Pytorch](https://pytorch.org/get-started/locally/) å®˜ç½‘å¯»æ‰¾å®‰è£…å‘½ä»¤ï¼ˆéœ€è¦ä¿è¯ PyTorch>=1.8ï¼‰

![image-20230907184516744](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309071845019.png)

```bash
# è¯·è‡ªè¡Œæ›¿æ¢å‘½ä»¤
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cpu
```



### æ‹‰å–ä»“åº“

```bash
git clone https://github.com/ultralytics/ultralytics.git
cd ultralytics
# å®‰è£…ä¾èµ–
pip install -e .
```



> å¦‚æœåªæ˜¯æƒ³è¦å¿«é€Ÿå°è¯•è®­ç»ƒè‡ªå®šä¹‰æ•°æ®é›†å¹¶é¢„æµ‹ç»“æœï¼Œå¯ä»¥è·³è¿‡åé¢ç« èŠ‚æ•™å­¦ï¼Œç›´æ¥è·³åˆ°æœ€åç« èŠ‚çš„å®æˆ˜æ¼”ç»ƒ



## ä¸¤ç§ä½¿ç”¨æ–¹å¼

### YOLO å‘½ä»¤è¡Œ

YOLOå‘½ä»¤è¡Œç•Œé¢ï¼ˆcommand line interface, CLIï¼‰ï¼Œ æ–¹ä¾¿åœ¨å„ç§ä»»åŠ¡å’Œç‰ˆæœ¬ä¸Šè®­ç»ƒã€éªŒè¯æˆ–æ¨æ–­æ¨¡å‹ã€‚CLIä¸éœ€è¦å®šåˆ¶æˆ–ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ yolo å‘½ä»¤ä»ç»ˆç«¯è¿è¡Œæ‰€æœ‰ä»»åŠ¡ã€‚

ã€YOLO CLI å®˜æ–¹æ–‡æ¡£ã€‘ï¼š[CLI - Ultralytics YOLOv8 Docs](https://docs.ultralytics.com/usage/cli/)

#### è¯­æ³•ï¼ˆUsageï¼‰

```bash
yolo TASK MODE ARGS

Where   TASK (optional) is one of [detect, segment, classify]
        MODE (required) is one of [train, val, predict, export, track]
        ARGS (optional) are any number of custom 'arg=value' pairs like 'imgsz=320' that override defaults.
```

æŸ¥çœ‹æ‰€æœ‰å‚æ•°ï¼š`yolo cfg`

#### è®­ç»ƒï¼ˆTrainï¼‰

åœ¨COCO128ä¸Šä»¥å›¾åƒå¤§å° 640 è®­ç»ƒ YOLOv8n 100 ä¸ª epoch

```bash
yolo detect train data=coco128.yaml model=yolov8n.pt epochs=100 imgsz=640
```

æ¢å¤ä¸­æ–­çš„è®­ç»ƒ

```bash
yolo detect train resume model=last.pt
```



#### éªŒè¯ï¼ˆValï¼‰

åœ¨COCO128æ•°æ®é›†ä¸ŠéªŒè¯ç»è¿‡è®­ç»ƒçš„ YOLOv8n æ¨¡å‹å‡†ç¡®æ€§ã€‚æ— éœ€ä¼ é€’å‚æ•°ï¼Œå› ä¸ºå®ƒ `model` ä¿ç•™äº†å®ƒçš„è®­ç»ƒ `data` å’Œå‚æ•°ä½œä¸ºæ¨¡å‹å±æ€§ã€‚

```bash
yolo detect val model=path/to/best.pt
```



#### é¢„æµ‹ï¼ˆPredictï¼‰

ä½¿ç”¨ç»è¿‡è®­ç»ƒçš„ YOLOv8n æ¨¡å‹å¯¹å›¾åƒè¿è¡Œé¢„æµ‹ã€‚

```bash
yolo detect predict model=path/to/best.pt source='https://ultralytics.com/images/bus.jpg'
```



#### å¯¼å‡ºï¼ˆExportï¼‰

å°† YOLOv8n æ¨¡å‹å¯¼å‡ºä¸ºä¸åŒçš„æ ¼å¼ï¼Œå¦‚ ONNXã€CoreML ç­‰ã€‚

```bash
yolo export model=path/to/best.pt format=onnx
```

å¯ç”¨å¯¼å‡ºå½¢å¼å¦‚ä¸‹

| Format æ ¼å¼   | format Argument | format è®ºç‚¹             | Model å‹ | Metadata å…ƒæ•°æ®                           | Arguments å‚æ•° |
| ------------- | --------------- | ----------------------- | -------- | ----------------------------------------- | -------------- |
| PyTorch       | -               | yolov8n.pt              | âœ…        | -                                         | -              |
| TorchScript   | torchscript     | yolov8n.torchscript     | âœ…        | imgsz, optimize                           | -              |
| ONNX          | onnx            | yolov8n.onnx            | âœ…        | imgsz, half, dynamic, simplify, opset     | -              |
| OpenVINO      | openvino        | yolov8n_openvino_model/ | âœ…        | imgsz, half                               | -              |
| TensorRT      | engine          | yolov8n.engine          | âœ…        | imgsz, half, dynamic, simplify, workspace | -              |
| CoreML        | coreml          | yolov8n.mlpackage       | âœ…        | imgsz, half, int8, nms                    | -              |
| TF SavedModel | saved_model     | yolov8n_saved_model/    | âœ…        | imgsz, keras                              | -              |
| TF GraphDef   | pb              | yolov8n.pb              | âŒ        | imgsz                                     | -              |
| TF Lite       | tflite          | yolov8n.tflite          | âœ…        | imgsz, half, int8                         | -              |
| TF Edge TPU   | edgetpu         | yolov8n_edgetpu.tflite  | âœ…        | imgsz                                     | -              |
| TF.js         | tfjs            | yolov8n_web_model/      | âœ…        | imgsz                                     | -              |
| PaddlePaddle  | paddle          | yolov8n_paddle_model/   | âœ…        | imgsz                                     | -              |
| ncnn          | ncnn            | yolov8n_ncnn_model/     | âœ…        | imgsz, half                               | -              |



#### è¦†ç›–é»˜è®¤é…ç½®æ–‡ä»¶

é¦–å…ˆä½¿ç”¨å‘½ä»¤ `yolo copy-cfg` åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª `default.yaml` çš„å‰¯æœ¬ `default_copy.yaml`ï¼Œä¹‹åå³å¯æŒ‡å®šé…ç½®æ–‡ä»¶æ¥è¦†ç›–é»˜è®¤é…ç½®æ–‡ä»¶

```bash
yolo cfg=default_copy.yaml imgsz=320
```



### Python è„šæœ¬

YOLOv8 å¯ä»¥æ— ç¼é›†æˆåˆ° Python é¡¹ç›®ä¸­ï¼Œä»¥è¿›è¡Œå¯¹è±¡æ£€æµ‹ã€åˆ†å‰²å’Œåˆ†ç±»ã€‚åŒæ—¶æ˜“äºä½¿ç”¨çš„ Python ç•Œé¢æ˜¯ä¸€ä¸ªå®è´µçš„èµ„æºï¼Œèƒ½å¤Ÿå¿«é€Ÿå®ç°é«˜çº§å¯¹è±¡æ£€æµ‹åŠŸèƒ½

ã€YOLO Python å®˜æ–¹æ–‡æ¡£ã€‘ï¼š[CLI - Ultralytics YOLOv8 Docs --- CLI - Ultralytics YOLOv8 æ–‡æ¡£](https://docs.ultralytics.com/usage/python/)

#### ç¤ºä¾‹

```bash
from ultralytics import YOLO

# ä»å¤´å¼€å§‹åˆ›å»ºä¸€ä¸ªæ–°çš„YOLOæ¨¡å‹
model = YOLO('yolov8n.yaml')

# åŠ è½½é¢„è®­ç»ƒçš„YOLOæ¨¡å‹ï¼ˆæ¨èç”¨äºè®­ç»ƒï¼‰
model = YOLO('yolov8n.pt')

# ä½¿ç”¨'coco128.yaml'æ•°æ®é›†å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒ3ä¸ªepoch
results = model.train(data='coco128.yaml', epochs=3)

# åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½
results = model.val()

# ä½¿ç”¨æ¨¡å‹å¯¹å›¾åƒè¿›è¡Œç›®æ ‡æ£€æµ‹
results = model('https://ultralytics.com/images/bus.jpg')

# å°†æ¨¡å‹å¯¼å‡ºä¸ºONNXæ ¼å¼
success = model.export(format='onnx')

```

![image-20230908110241109](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081102474.png)

![image-20230908112306725](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081123847.png)





#### è®­ç»ƒ

è®­ç»ƒæ¨¡å¼ç”¨äºåœ¨è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè®­ç»ƒ YOLOv8 æ¨¡å‹ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨æŒ‡å®šçš„æ•°æ®é›†å’Œè¶…å‚æ•°è®­ç»ƒæ¨¡å‹ã€‚è®­ç»ƒè¿‡ç¨‹æ¶‰åŠä¼˜åŒ–æ¨¡å‹çš„å‚æ•°ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å‡†ç¡®åœ°é¢„æµ‹å›¾åƒä¸­å¯¹è±¡çš„ç±»åˆ«å’Œä½ç½®ã€‚

é¢„è®­ç»ƒï¼ˆFrom pretrained æ¨èä½¿ç”¨ï¼‰

```bash
from ultralytics import YOLO

model = YOLO('yolov8n.pt') # pass any model type
results = model.train(epochs=5)
```

åˆå§‹è®­ç»ƒï¼ˆFrom scratchï¼‰

```bash
from ultralytics import YOLO

model = YOLO('yolov8n.yaml')
results = model.train(data='coco128.yaml', epochs=5)
```

æ¢å¤è®­ç»ƒï¼ˆResumeï¼‰

```bash
model = YOLO("last.pt")
results = model.train(resume=True)
```



#### éªŒè¯

Val æ¨¡å¼ç”¨äºåœ¨è®­ç»ƒ YOLOv8 æ¨¡å‹åå¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹ï¼Œä»¥è¡¡é‡å…¶å‡†ç¡®æ€§å’Œæ³›åŒ–æ€§èƒ½ã€‚æ­¤æ¨¡å¼å¯ç”¨äºè°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ä»¥æé«˜å…¶æ€§èƒ½ã€‚

è®­ç»ƒåéªŒè¯

```bash
from ultralytics import YOLO

# å¯¼å…¥YOLOæ¨¡å‹
model = YOLO('yolov8n.yaml')

# ä½¿ç”¨'coco128.yaml'æ•°æ®é›†å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒ5ä¸ªepoch
model.train(data='coco128.yaml', epochs=5)

# å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œè‡ªåŠ¨è¯„ä¼°
model.val()  # å®ƒä¼šè‡ªåŠ¨è¯„ä¼°æ‚¨è®­ç»ƒçš„æ•°æ®ã€‚
```



å•ç‹¬éªŒè¯

```bash
from ultralytics import YOLO

# å¯¼å…¥YOLOæ¨¡å‹
model = YOLO("model.pt")
# å¦‚æœæ‚¨æ²¡æœ‰è®¾ç½®dataå‚æ•°ï¼Œå®ƒå°†ä½¿ç”¨model.ptä¸­çš„æ•°æ®YAMLæ–‡ä»¶ã€‚
model.val()
# æˆ–è€…æ‚¨å¯ä»¥è®¾ç½®è¦éªŒè¯çš„æ•°æ®
model.val(data='coco128.yaml')
```





#### é¢„æµ‹

é¢„æµ‹æ¨¡å¼ç”¨äºä½¿ç”¨ç»è¿‡è®­ç»ƒçš„ YOLOv8 æ¨¡å‹å¯¹æ–°å›¾åƒæˆ–è§†é¢‘è¿›è¡Œé¢„æµ‹ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹ä»æ£€æŸ¥ç‚¹æ–‡ä»¶åŠ è½½ï¼Œç”¨æˆ·å¯ä»¥æä¾›å›¾åƒæˆ–è§†é¢‘æ¥æ‰§è¡Œæ¨ç†ã€‚è¯¥æ¨¡å‹é¢„æµ‹è¾“å…¥å›¾åƒæˆ–è§†é¢‘ä¸­å¯¹è±¡çš„ç±»åˆ«å’Œä½ç½®ã€‚


```bash
from ultralytics import YOLO
from PIL import Image
import cv2

model = YOLO("model.pt")
# æ¥å—å„ç§æ ¼å¼ - å›¾åƒ/ç›®å½•/è·¯å¾„/URL/è§†é¢‘/PIL/ndarrayã€‚0è¡¨ç¤ºç½‘ç»œæ‘„åƒå¤´
results = model.predict(source="0")
results = model.predict(source="folder", show=True) # æ˜¾ç¤ºé¢„æµ‹ç»“æœã€‚æ¥å—æ‰€æœ‰YOLOé¢„æµ‹å‚æ•°

# ä½¿ç”¨PILåº“
im1 = Image.open("bus.jpg")
results = model.predict(source=im1, save=True)  # ä¿å­˜ç»˜åˆ¶çš„å›¾åƒ

# ä½¿ç”¨ndarray
im2 = cv2.imread("bus.jpg")
results = model.predict(source=im2, save=True, save_txt=True)  # å°†é¢„æµ‹ç»“æœä¿å­˜ä¸ºæ ‡ç­¾

# ä½¿ç”¨PIL/ndarrayåˆ—è¡¨
results = model.predict(source=[im1, im2])
```



#### å¯¼å‡º

å¯¼å‡ºæ¨¡å¼ç”¨äºå°† YOLOv8 æ¨¡å‹å¯¼å‡ºä¸ºå¯ç”¨äºéƒ¨ç½²çš„æ ¼å¼ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹å°†è½¬æ¢ä¸ºå¯ä¾›å…¶ä»–è½¯ä»¶åº”ç”¨ç¨‹åºæˆ–ç¡¬ä»¶è®¾å¤‡ä½¿ç”¨çš„æ ¼å¼ã€‚å°†æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œæ­¤æ¨¡å¼éå¸¸æœ‰ç”¨ã€‚

```bash
from ultralytics import YOLO

model = YOLO('yolov8n.pt')
model.export(format='onnx', dynamic=True)
```





#### è·Ÿè¸ª

è·Ÿè¸ªæ¨¡å¼ç”¨äºä½¿ç”¨ YOLOv8 æ¨¡å‹å®æ—¶è·Ÿè¸ªå¯¹è±¡ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹ä»æ£€æŸ¥ç‚¹æ–‡ä»¶åŠ è½½ï¼Œç”¨æˆ·å¯ä»¥æä¾›å®æ—¶è§†é¢‘æµæ¥æ‰§è¡Œå®æ—¶å¯¹è±¡è·Ÿè¸ªã€‚æ­¤æ¨¡å¼å¯¹äºç›‘æ§ç³»ç»Ÿæˆ–è‡ªåŠ¨é©¾é©¶æ±½è½¦ç­‰åº”ç”¨éå¸¸æœ‰ç”¨ã€‚

```bash
from ultralytics import YOLO

# åŠ è½½æ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½å®˜æ–¹çš„æ£€æµ‹æ¨¡å‹
model = YOLO('yolov8n-seg.pt')  # åŠ è½½å®˜æ–¹çš„åˆ†å‰²æ¨¡å‹
model = YOLO('path/to/best.pt')  # åŠ è½½è‡ªå®šä¹‰æ¨¡å‹

# ä½¿ç”¨æ¨¡å‹è¿›è¡Œç›®æ ‡è·Ÿè¸ª
results = model.track(source="https://youtu.be/Zgi9g1ksQHc", show=True)
results = model.track(source="https://youtu.be/Zgi9g1ksQHc", show=True, tracker="bytetrack.yaml")
```



#### è®­ç»ƒå™¨

YOLOæ¨¡å‹ç±»æ˜¯Trainerç±»çš„é«˜çº§åŒ…è£…å™¨ã€‚æ¯ä¸ªYOLOä»»åŠ¡éƒ½æœ‰è‡ªå·±çš„ä»BaseTrainerç»§æ‰¿æ¥çš„è®­ç»ƒå™¨ã€‚

```bash
from ultralytics.yolo import v8 import DetectionTrainer, DetectionValidator, DetectionPredictor

# trainer
trainer = DetectionTrainer(overrides={})
trainer.train()
trained_model = trainer.best

# Validator
val = DetectionValidator(args=...)
val(model=trained_model)

# predictor
pred = DetectionPredictor(overrides={})
pred(source=SOURCE, model=trained_model)

# resume from last weight
overrides["resume"] = trainer.last
trainer = detect.DetectionTrainer(overrides=overrides)
```



## å¤šä»»åŠ¡æ”¯æŒ

ä¸‹é¢ç¤ºä¾‹ä¸»è¦ä½¿ç”¨ Python è„šæœ¬çš„å½¢å¼ï¼ŒCLI å½¢å¼å¯ä»¥è‡ªè¡Œåˆ°å®˜ç½‘æ‰¾åˆ°å¯¹åº”ç¤ºä¾‹ä»£ç 

å®˜æ–¹æ–‡æ¡£ï¼š[Train - Ultralytics YOLOv8 Docs](https://docs.ultralytics.com/modes/train/)

### ç›®æ ‡æ£€æµ‹

ç‰©ä½“æ£€æµ‹æ˜¯ä¸€é¡¹æ¶‰åŠè¯†åˆ«å›¾åƒæˆ–è§†é¢‘æµä¸­ç‰©ä½“çš„ä½ç½®å’Œç±»åˆ«çš„ä»»åŠ¡ã€‚

å¯¹è±¡æ£€æµ‹å™¨çš„è¾“å‡ºæ˜¯ä¸€ç»„åŒ…å›´å›¾åƒä¸­çš„å¯¹è±¡çš„åŒ…å›´æ¡†ï¼Œä»¥åŠæ¯ä¸ªæ¡†çš„ç±»æ ‡ç­¾å’Œç½®ä¿¡åº¦åˆ†æ•°ã€‚å½“ä½ éœ€è¦è¯†åˆ«åœºæ™¯ä¸­æ„Ÿå…´è¶£çš„ç‰©ä½“ï¼Œä½†ä¸éœ€è¦çŸ¥é“ç‰©ä½“çš„ç¡®åˆ‡ä½ç½®æˆ–å®ƒçš„ç¡®åˆ‡å½¢çŠ¶æ—¶ï¼Œç‰©ä½“æ£€æµ‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚

#### è®­ç»ƒ

åœ¨å›¾åƒå¤§å°ä¸º 640 çš„ COCO128 æ•°æ®é›†ä¸Šè®­ç»ƒ YOLOv8n 100 ä¸ª epochã€‚

è®¾å¤‡æ˜¯è‡ªåŠ¨ç¡®å®šçš„ã€‚å¦‚æœ GPU å¯ç”¨ï¼Œåˆ™å°†ä½¿ç”¨å®ƒï¼Œå¦åˆ™å°†åœ¨ CPU ä¸Šå¼€å§‹è®­ç»ƒã€‚

```bash
from ultralytics import YOLO

# åŠ è½½ä¸€ä¸ªæ¨¡å‹
model = YOLO('yolov8n.yaml')  # ä»YAMLæ–‡ä»¶æ„å»ºä¸€ä¸ªæ–°æ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹ï¼ˆæ¨èç”¨äºè®­ç»ƒï¼‰
model = YOLO('yolov8n.yaml').load('yolov8n.pt')  # ä»YAMLæ–‡ä»¶æ„å»ºæ¨¡å‹å¹¶åŠ è½½æƒé‡

# è®­ç»ƒæ¨¡å‹
results = model.train(data='coco128.yaml', epochs=100, imgsz=640)
```

å¯ä»¥ä½¿ç”¨ `device` å‚æ•°æŒ‡å®šè®­ç»ƒè®¾å¤‡ã€‚å¦‚æœæœªä¼ é€’ä»»ä½•å‚æ•°ï¼Œåˆ™å°†ä½¿ç”¨ GPU `device=0` ï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼Œå¦åˆ™ `device=cpu` å°†ä½¿ç”¨ã€‚

```bash
from ultralytics import YOLO

# åŠ è½½ä¸€ä¸ªæ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹ï¼ˆæ¨èç”¨äºè®­ç»ƒï¼‰

# ä½¿ç”¨2ä¸ªGPUè®­ç»ƒæ¨¡å‹
results = model.train(data='coco128.yaml', epochs=100, imgsz=640, device=[0, 1])
```



#### éªŒè¯

Val æ¨¡å¼ç”¨äºåœ¨è®­ç»ƒ YOLOv8 æ¨¡å‹åå¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹ï¼Œä»¥è¡¡é‡å…¶å‡†ç¡®æ€§å’Œæ³›åŒ–æ€§èƒ½ã€‚æ­¤æ¨¡å¼å¯ç”¨äºè°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ä»¥æé«˜å…¶æ€§èƒ½ã€‚

YOLOv8 æ¨¡å‹ä¼šè‡ªåŠ¨è®°ä½å…¶è®­ç»ƒè®¾ç½®ï¼Œå› æ­¤æ‚¨åªéœ€ `yolo val model=yolov8n.pt` ä½¿ç”¨ or `model('yolov8n.pt').val()` å³å¯åœ¨åŸå§‹æ•°æ®é›†ä¸Šè½»æ¾éªŒè¯ç›¸åŒå›¾åƒå¤§å°å’ŒåŸå§‹æ•°æ®é›†ä¸Šçš„æ¨¡å‹

åœ¨COCO128æ•°æ®é›†ä¸ŠéªŒè¯ç»è¿‡è®­ç»ƒçš„ YOLOv8n æ¨¡å‹å‡†ç¡®æ€§ã€‚æ— éœ€ä¼ é€’å‚æ•°ï¼Œå› ä¸ºå®ƒ `model` ä¿ç•™äº†å®ƒçš„è®­ç»ƒ `data` å’Œå‚æ•°ä½œä¸ºæ¨¡å‹å±æ€§

```bash
from ultralytics import YOLO

# å¯¼å…¥æ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½ä¸€ä¸ªå®˜æ–¹æ¨¡å‹
model = YOLO('path/to/best.pt')  # åŠ è½½ä¸€ä¸ªè‡ªå®šä¹‰æ¨¡å‹

# éªŒè¯æ¨¡å‹
metrics = model.val()  # ä¸éœ€è¦å‚æ•°ï¼Œæ•°æ®é›†å’Œè®¾ç½®ä¼šè¢«è®°ä½
metrics.box.map    # mAP50-95
metrics.box.map50  # mAP50
metrics.box.map75  # mAP75
metrics.box.maps   # åŒ…å«æ¯ä¸ªç±»åˆ«çš„mAP50-95çš„åˆ—è¡¨
```



#### é¢„æµ‹

YOLOv8 é¢„æµ‹æ¨¡å¼å¯ä»¥ä¸ºå„ç§ä»»åŠ¡ç”Ÿæˆé¢„æµ‹ï¼Œåœ¨ä½¿ç”¨æµå¼å¤„ç†æ¨¡å¼æ—¶è¿”å›å¯¹è±¡åˆ—è¡¨æˆ–å†…å­˜é«˜æ•ˆçš„ `Results` `Results` å¯¹è±¡ç”Ÿæˆå™¨ã€‚é€šè¿‡ä¼ å…¥ `stream=True` é¢„æµ‹å™¨çš„è°ƒç”¨æ–¹æ³•æ¥å¯ç”¨æµå¼å¤„ç†æ¨¡å¼ã€‚

YOLOv8 å¯ä»¥å¤„ç†ä¸åŒç±»å‹çš„è¾“å…¥æºè¿›è¡Œæ¨ç†ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚æºåŒ…æ‹¬é™æ€å›¾åƒã€è§†é¢‘æµå’Œå„ç§æ•°æ®æ ¼å¼ã€‚è¯¥è¡¨è¿˜æŒ‡ç¤ºæ¯ä¸ªæºæ˜¯å¦å¯ä»¥åœ¨æµæ¨¡å¼ä¸‹ä¸å‚æ•° `stream=True` âœ…ä¸€èµ·ä½¿ç”¨ã€‚æµå¼ä¼ è¾“æ¨¡å¼æœ‰åˆ©äºå¤„ç†è§†é¢‘æˆ–å®æ—¶æµï¼Œå› ä¸ºå®ƒä¼šåˆ›å»ºç»“æœç”Ÿæˆå™¨ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰å¸§åŠ è½½åˆ°å†…å­˜ä¸­

```bash
from ultralytics import YOLO

# å¯¼å…¥æ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒçš„YOLOv8næ¨¡å‹

# å¯¹å›¾åƒåˆ—è¡¨è¿›è¡Œæ‰¹é‡æ¨ç†
results = model(['im1.jpg', 'im2.jpg'])  # è¿”å›ä¸€ä¸ªResultså¯¹è±¡åˆ—è¡¨

# å¤„ç†ç»“æœåˆ—è¡¨
for result in results:
    boxes = result.boxes  # ç”¨äºè¾¹ç•Œæ¡†è¾“å‡ºçš„Boxeså¯¹è±¡
    masks = result.masks  # ç”¨äºåˆ†å‰²æ©æ¨¡è¾“å‡ºçš„Maskså¯¹è±¡
    keypoints = result.keypoints  # ç”¨äºå§¿åŠ¿è¾“å‡ºçš„Keypointså¯¹è±¡
    probs = result.probs  # ç”¨äºåˆ†ç±»è¾“å‡ºçš„Probså¯¹è±¡
```





#### å¯¼å‡º

å¯¼å‡ºæ¨¡å¼ç”¨äºå°† YOLOv8 æ¨¡å‹å¯¼å‡ºä¸ºå¯ç”¨äºéƒ¨ç½²çš„æ ¼å¼ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹å°†è½¬æ¢ä¸ºå¯ä¾›å…¶ä»–è½¯ä»¶åº”ç”¨ç¨‹åºæˆ–ç¡¬ä»¶è®¾å¤‡ä½¿ç”¨çš„æ ¼å¼ã€‚å°†æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œæ­¤æ¨¡å¼éå¸¸æœ‰ç”¨ã€‚

```bash
from ultralytics import YOLO

# å¯¼å…¥æ¨¡å‹
model = YOLO('yolov8n.pt')  # åŠ è½½ä¸€ä¸ªå®˜æ–¹æ¨¡å‹
model = YOLO('path/to/best.pt')  # åŠ è½½ä¸€ä¸ªè‡ªå®šä¹‰è®­ç»ƒçš„æ¨¡å‹

# å¯¼å‡ºæ¨¡å‹
model.export(format='onnx')
```



å®ä¾‹åˆ†å‰²å’Œç›®æ ‡åˆ†ç±»æ­¤å¤„ä¸å†èµ˜è¿°ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾å®˜æ–¹æ–‡æ¡£



## å®æˆ˜æ¼”ç»ƒ

ä¸‹é¢å°†ä¼šè‡ªå®šä¹‰è®­ç»ƒç›®æ ‡æ£€æµ‹æ•°æ®é›†

æ³¨æ„ï¼šæ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œè·¯å¾„å‡æ˜¯ä»¥é¡¹ç›®æ ¹ç›®å½•ä¸ºå‡†

### å®˜æ–¹æ•°æ®é›†

é¦–å…ˆä¸‹è½½æƒé‡æ–‡ä»¶å¹¶å°†æ”¾åˆ° `ultralytics` é¡¹ç›®æ ¹ç›®å½•



![image-20230908154536606](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081545946.png)



ä¹‹åæµ‹è¯•é¢„è®­ç»ƒæ¨¡å‹çš„æ•ˆæœï¼Œåœ¨æ ¹ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤

```bash
yolo predict model=yolov8n.pt source=ultralytics/assets/bus.jpg
```

![image-20230908160147447](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081601732.png)



ä¹‹åæˆ‘ä»¬æŸ¥çœ‹ä¿å­˜çš„æ£€æµ‹å¥½çš„å›¾ç‰‡ `/root/Development/ultralytics/runs/detect/predict2`

![image-20230908160310209](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081603809.png)



è®­ç»ƒ COCO128 æ•°æ®é›†ï¼ˆè¿™é‡Œå¯ä»¥é…ç½® tensorboard å¯è§†åŒ–é¢æ¿ï¼Œè¿™é‡Œä¸èµ˜è¿°ï¼‰

```bash
yolo train data=coco128.yaml model=yolov8n.pt epochs=3 lr0=0.01 batch=4
```

ä¸æ­¤åŒæ—¶æ ¹ç›®å½•ä¸‹é¢ç”Ÿæˆäº†ä¸€ä¸ªdatasetsæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ coco128 çš„æ•°æ®é›†

>æ³¨æ„ï¼šè¿™é‡Œçš„ datasets ä¸‹è½½ç›®å½•æ˜¯åœ¨ `~/.config/Ultralytics/settings.yaml` æ–‡ä»¶ä¸­å®šä¹‰çš„ï¼Œå¯ä»¥åç»­ä¿®æ”¹



![image-20230908162607162](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081626456.png)

ä¹‹åæŸ¥çœ‹å­˜å‚¨çš„è®­ç»ƒç»“æœçš„æ–‡ä»¶å¤¹ï¼Œweights æ–‡ä»¶å¤¹é‡Œé¢è£…çš„æ˜¯æ•ˆæœæœ€å¥½çš„ä¸€æ¬¡æƒé‡æ–‡ä»¶ä»¥åŠæœ€åä¸€è½®è®­ç»ƒçš„æƒé‡æ–‡ä»¶



### è‡ªå®šä¹‰æ•°æ®é›†

#### ä¸‹è½½æ•°æ®é›†

ã€ä¸‹è½½åœ°å€ã€‘ï¼š[Mask Wearing Dataset - raw (roboflow.com)](https://public.roboflow.com/object-detection/mask-wearing/4)

![image-20230907185115131](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309071851501.png)

ç„¶åä¸‹è½½ zip å‹ç¼©åŒ…å³å¯



#### é…ç½®æ•°æ®é›†

ä¸Šä¼ åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `datasets`ï¼Œå¹¶é‡å‘½åæ•°æ®é›†ä¸º `MaskDataSet`ï¼ˆæœ¬æ¬¡æ¼”ç¤ºç›´æ¥ä½¿ç”¨ä¸‹è½½çš„æ•°æ®é›†ï¼Œåé¢çš„éƒ¨åˆ†æ­¥éª¤æ˜¯é’ˆå¯¹è‡ªå·±åˆ¶ä½œæ•°æ®é›†çš„è¦æ±‚ï¼‰

`data.yaml`ä¿®æ”¹å¦‚ä¸‹

```bash
path: ../datasets/MaskDataSet
train: ./train/images
val: ./valid/images
test: ./test/images

nc: 2
names: ['mask', 'no-mask']

roboflow:
  workspace: joseph-nelson
  project: mask-wearing
  version: 4
  license: Public Domain
  url: https://universe.roboflow.com/joseph-nelson/mask-wearing/dataset/4
```





#### åˆ’åˆ†æ•°æ®é›†

æˆ‘ä»¬éœ€è¦å°†æ•°æ®é›†æŒ‰ç…§æŒ‡å®šæ¯”ä¾‹åˆ’åˆ†ï¼ˆè®­ç»ƒé›†:éªŒè¯é›†:æµ‹è¯•é›†=7:2:1ï¼‰

ã€æ•°æ®é›†åˆ’åˆ†è„šæœ¬ã€‘ï¼š[division-of-data/DivisionOfData.py at main Â· kuisec/division-of-data (github.com)](https://github.com/kuisec/division-of-data/blob/main/DivisionOfData.py)



#### æ ‡æ³¨æ•°æ®é›†

å®‰è£… lablemeï¼Œæ‰§è¡Œ `pip install labelme`ï¼Œç„¶åå‘½ä»¤è¡Œè¾“å…¥ `labelme`å³å¯è¿›å…¥å›¾å½¢åŒ–ç•Œé¢

ä½†æ˜¯æ³¨æ„ï¼šlabelme ç”Ÿæˆçš„æ ‡ç­¾æ˜¯ json æ–‡ä»¶çš„æ ¼å¼ï¼Œåç»­éœ€è¦è½¬åŒ–æˆ txt æ–‡ä»¶æ‰èƒ½è¢« yolov ä½¿ç”¨

è¿™é‡Œè¯´ä¸‹ä¸¤ç§æ ‡æ³¨å·¥å…· **labelImg å’Œ labelme** çš„åŒºåˆ«

labelimg æ˜¯ä¸€ç§çŸ©å½¢æ ‡æ³¨å·¥å…·ï¼Œå¸¸ç”¨äºç›®æ ‡è¯†åˆ«å’Œç›®æ ‡æ£€æµ‹ï¼Œå…¶æ ‡è®°æ•°æ®è¾“å‡ºä¸º.xmlå’Œ.txt

labelme æ˜¯ä¸€ç§å¤šè¾¹å½¢æ ‡æ³¨å·¥å…·ï¼Œå¯ä»¥å‡†ç¡®çš„å°†è½®å»“æ ‡æ³¨å‡ºæ¥ï¼Œå¸¸ç”¨äºåˆ†å‰²ï¼Œå…¶æ ‡è®°è¾“å‡ºæ ¼å¼ä¸ºjson



ã€æ•°æ®é›†æ ‡æ³¨æ–‡ä»¶æ ¼å¼è½¬æ¢è„šæœ¬ã€‘ï¼š[DeepLearning/others/label_convert at master Â· KKKSQJ/DeepLearning (github.com)](https://github.com/KKKSQJ/DeepLearning/tree/master/others/label_convert)



#### è®­ç»ƒæ•°æ®é›†

```bash
yolo train data=datasets/MaskDataSet/data.yaml model=yolov8n.pt epochs=10 lr0=0.01 batch=4
```

![image-20230908194611414](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081946545.png)

ä½¿ç”¨æ•ˆæœæœ€å¥½çš„æƒé‡æ–‡ä»¶è¿›è¡Œé¢„æµ‹æµ‹è¯•ï¼ˆéœ€è¦æå‰ä¸Šä¼  `ultralytics/assets/mask.jpg`å£ç½©å›¾ç‰‡ï¼‰

```bash
yolo predict model=runs/detect/train26/weights/best.pt source=ultralytics/assets/mask.jpg
```

æŸ¥çœ‹æœ€ç»ˆæ•ˆæœ

![image-20230908194753360](https://cdn.jsdelivr.net/gh/Returntmp/blog-image@main/blog/202309081947828.png)







## å‚è€ƒæ–‡ç« 

[YOLOv8è¯¦è§£ ã€ç½‘ç»œç»“æ„+ä»£ç +å®æ“ã€‘_zyw2002çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/zyw2002/article/details/128732494)

[YOLOv8æ•™ç¨‹ç³»åˆ—ï¼šä¸€ã€ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†è®­ç»ƒYOLOv8æ¨¡å‹ï¼ˆè¯¦ç»†ç‰ˆæ•™ç¨‹ï¼Œä½ åªçœ‹ä¸€ç¯‡-ï¼è°ƒå‚æ”»ç•¥ï¼‰ï¼ŒåŒ…å«ç¯å¢ƒæ­å»º/æ•°æ®å‡†å¤‡/æ¨¡å‹è®­ç»ƒ/é¢„æµ‹/éªŒè¯/å¯¼å‡ºç­‰_Zhijun.li@Studioçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_45921929/article/details/128673338)

[é›¶åŸºç¡€æ•™ç¨‹ï¼šä½¿ç”¨yolov8è®­ç»ƒè‡ªå·±çš„ç›®æ ‡æ£€æµ‹æ•°æ®é›†_Dragon_0010çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/pyscl01/article/details/132583208)

[YOLOv5å®æ“â€”â€”æ£€æµ‹æ˜¯å¦æˆ´å£ç½©-CSDNåšå®¢](https://blog.csdn.net/zyw2002/article/details/122995823)